# 家目錄名稱的處理

## 場景

Active Directory 網域使用中文名，當locoal machine的使用者名稱與AD重複，AD使用者家目錄會變成 `user.中文網域`，造成某些軟體如 node.js 無法處理中文部份.

[\[Win11\] 簡單更改使用者資料夾名稱 打錯使用者名稱不用怕 不需重灌 不需第三方程式 - 零科技](https://zerotech.club/rename-user-home-folder/)

## 步驟

1. 使用Administrator權限登入（要修改的帳戶要確定logout）
   ```PowerShell
   Get-CimInstance -ClassName Win32_UserAccount | Select-Object Name, SID
   ```
2. 對照SID並修改windows registry，registry位址（PowerShell表示方式）
   `HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList`
3. 對照SID並取得ProfileImagePath的value，並改成新資料夾位址
4. 登入或重新開機測試

## 備註

- 家目錄有些預設資料夾如download可直接使用檔案總管更改資料夾位址
